# TP 05 : Le *Design Pattern* Builder â€” Projet RequÃªte HTTP

[â¬‡ï¸ TÃ©lÃ©charger le TP (tp05.zip)](tp05.zip)

!!! note "Objectif du TP"

    Lâ€™objectif de ce TP est de dÃ©couvrir et de pratiquer le **design pattern de crÃ©ation : le Builder**,  
    Ã  travers un mini-projet concret : **la construction de requÃªtes HTTP complexes**.

    Vous allez :

    - construire des requÃªtes HTTP sans Builder pour constater les limites ;
    - ajouter des rÃ¨gles de cohÃ©rence rendant la construction difficile ;
    - implÃ©menter un **HttpRequestBuilder** propre, fluide et sÃ©curisÃ© ;
    - comparer les deux approches ;

---

!!! note "Instructions prÃ©liminaires"

    Avant de commencer ce TP, vous devez :

    1. CrÃ©er un **nouveau dÃ©pÃ´t GitHub** nommÃ© `tp05-builder-http`.  
    2. Ajouter le compte **[@rezakaziz](https://github.com/rezakaziz)** comme **collaborateur** du projet.  
    3. Cloner votre dÃ©pÃ´t et travailler dessus localement.  
    4. Commiter et pousser rÃ©guliÃ¨rement vos modifications :
       ```bash
       git add .
       git commit -m "progression"
       git push
       ```

---

!!! info "Note"
    Les tests unitaires sont Ã  Ã©crire par lâ€™Ã©tudiant.

---

## Exercice 1 

!!! note "Contexte"

    Vous devez reprÃ©senter une **requÃªte HTTP** sous forme dâ€™objet Java.  
    Pour cela, on vous fournit une classe `HttpRequest` avec un constructeur volontairement trÃ¨s lourd.
---

!!! Question "Question 1 â€” Construire deux requÃªtes"

    Dans le package `exo1.without_builder`, ImplÃ©menter la classe `Main1` qui construit **deux** requÃªtes HTTP en utilisant le constructeur :

    - une requÃªte : `GET /users?limit=10`  
    - une requÃªte : `POST /login` avec un body JSON

    Travail demandÃ© :

    - Utiliser le constructeur tel quel, **avec tous les paramÃ¨tres** (Manipuler `null` si nÃ©cessaire).  
    - Commentez en quelques lignes la lisibilitÃ© de cette approche et les erreurs possible. 
    
    ---

!!! Question "Question 2 â€” Ajouter des rÃ¨gles de cohÃ©rence"

    **Sans toucher Ã  la classe HttpRequest**, On veut rajouter les rÃ¨gles suivantes :

    - Une requÃªte **GET** ne peut jamais avoir de body.  
    - Une requÃªte **doit obligatoirement avoir un host**.  
    - `keepAlive = true` et `followRedirects = true` sont incompatibles.

    Travail demandÃ© :

    - Ajouter ces validations dans `Main1` ou via une mÃ©thode auxiliaire.  
    - Expliquer en quelques lignes pourquoi cette approche devient difficile Ã  maintenir et Ã  Ã©tendre.

---



!!! note "Objectif"

    Nous allons remplacer la construction par un **HttpRequestBuilder**,  
    permettant de crÃ©er une requÃªte Ã©tape par Ã©tape, de maniÃ¨re **fluide**, **claire** et **sÃ©curisÃ©e**.

---

!!! Question "Question 3 â€” ImplÃ©menter `HttpRequestBuilder`"

    ImplÃ©menter une classe `HttpRequestBuilder`.

    Contraintes :

    - `host` obligatoire  
    - body interdit si `method = GET`  
    - `keepAlive` et `followRedirects` ne peuvent pas Ãªtre `true` simultanÃ©ment  

    Tests Ã  Ã©crire :

    - construction valide  
    - absence de host  
    - body interdit sur GET  
    - combinaison illÃ©gale keepAlive/followRedirects  

---

!!! Question "Question 4 â€” RÃ©Ã©crire le code client"

    RÃ©Ã©crire vos deux requÃªtes initiales dans une classe `Main2` :

    ```java
    HttpRequest req = new HttpRequestBuilder()
        .method(...)
        .url(...)
        .host(...)
        .body(...)
        .timeout(...)
        .build();
    ```

    Travail demandÃ© :

    - Comparer en quelques lignes :  
        - la lisibilitÃ© avant/aprÃ¨s  
        - la facilitÃ© dâ€™ajout de nouvelles options  
        - la sÃ©curitÃ© et la cohÃ©rence des Ã©tats  


## Exercice 2

!!! note "Contexte"

    On dispose de fichiers contenant des informations sur des Ã©tudiants :

    ```
    numÃ©ro:nom:prÃ©nom:note1:note2:note3:...
    ```

    Ainsi que dâ€™une classe `LecteurFichierEtudiants` fournissant un objet contenant la liste des Ã©tudiants.

    Une classe `Etudiant` (numÃ©ro, nom, prÃ©nom, liste de notes) est fournie.  
    Une interface `ListEtudiantBuilder` est fournie et une implÃ©mentation partielle de cette interface dans `ArrayListEtudiantBuilder` 
    

---

!!! Question "Question â€” DÃ©boguer `ArrayListEtudiantsBuilder`"

    Lâ€™un des tests fournis Ã©choue.

    ğŸ”§ Travail demandÃ© :

    - Comprendre pourquoi un test Ã©choue.
    - Corriger le bug dans la classe `ArrayListEtudiantsBuilder`.
    
    ğŸ§ª Tests Ã  Ã©crire :

    - fichier avec 3 Ã©tudiants ;
    - Ã©tudiant sans notes ;
    - Ã©tudiant avec espaces dans le nom ;
    - Ã©tudiant avec beaucoup de notes.


---

