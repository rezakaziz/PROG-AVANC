# TP 03 : Rappels de conception objet

[‚¨áÔ∏è T√©l√©charger le TP (tp03.zip)](tp03.zip)

!!! note "Objectif du TP"
    
    L‚Äôobjectif de ce TP est de consolider vos connaissances en **programmation orient√©e objet** :  
    - r√©duction du **couplage** entre classes,  
    - respect de la **loi de D√©m√©ter**,  
    - et mise en pratique de principes de **bonne conception logicielle** (interfaces, d√©pendances invers√©es, r√©utilisabilit√©).

!!! note Instructions pr√©liminaires

    Avant de commencer ce TP, vous devez :

    1. Cr√©er un **nouveau d√©p√¥t GitHub** nomm√© `tp03-conception-objet`.  
    2. Ajouter le compte **[@rezakaziz](https://github.com/rezakaziz)** comme **collaborateur** du projet.  
    - Allez dans `Settings` ‚Üí `Collaborators` ‚Üí `Add people` ‚Üí recherchez `rezakaziz`.
    3. Clonez votre d√©p√¥t en local et travaillez dessus pour les exercices suivants.  
    4. Commitez et poussez r√©guli√®rement vos modifications (`git add .`, `git commit -m "progression"`, `git push`).

---

## Exercice 1 : Suppression du couplage
!!! Question "Question 1 ‚Äî R√©duire le couplage avec un logger"

    Un logiciel de calcul enregistre (ou *logge*) ses √©tapes pour permettre une v√©rification ult√©rieure.  
    L‚Äôimpl√©mentation actuelle se trouve dans le package `exo1q1v1`.

    Cependant, la classe `FileLogger` utilis√©e rend les tests unitaires difficiles √† √©crire et √† maintenir.

    üí≠ **Analyse du probl√®me**

    - Les exceptions lanc√©es par le logger sont-elles bien g√©r√©es dans le code actuel ?  
    - Pourquoi cette approche rend-elle le logiciel moins flexible ?

    üí° **Travail demand√©**

    1. Dans le package `exo1q1v2`, cr√©ez une **interface** pour r√©duire le couplage.
    2. Fournissez **trois impl√©mentations** :
        - `NullLogger` : ne fait rien (utile pour d√©sactiver les logs)  
        - `MemoryLogger` : stocke les messages dans une `ArrayList<String>` (utile pour les tests)  
        - `FileLogger` : reprend le comportement initial (√©criture dans un fichier)
    3. Modifiez le code du calcul pour qu‚Äôil d√©pende de l‚Äô**interface** et non plus d‚Äôune classe concr√®te.
    4. **R√©fl√©chissez** : qui doit instancier le logger et pourquoi ?  
       

---

!!! Question "Question 2 ‚Äî Exportation flexible du catalogue"

    On dispose d‚Äôune classe `Catalogue` repr√©sentant un ensemble de produits.  
    Dans le package `exo1q2v1`, cette classe peut exporter son contenu au format **XML** via une classe `XMLDumper`.

    Cependant, le couplage entre `Catalogue` et `XMLDumper` est **trop fort** :  
    la classe `Catalogue` ne devrait pas d√©pendre d‚Äôun format sp√©cifique.

    üí≠ **Probl√®me √† r√©soudre**

    - Pourquoi le fait que `Catalogue` appelle directement `XMLDumper` pose-t-il probl√®me ?  
    - Comment rendre cette architecture extensible pour d‚Äôautres formats (JSON, YAML, etc.) ?

    üí° **Travail demand√©**

    1. Concevez une **abstraction** qui s√©pare la logique m√©tier (`Catalogue`) du format d‚Äôexportation.  
    2. Impl√©mentez au moins deux exporteurs :
        - `XMLDumper` : exporte en XML (impl√©mentation existante adapt√©e √† la nouvelle interface)
        - `JSONDumper` : exporte en JSON
    3. (Optionnel, si vous avez le temps) : ajoutez un `YAMLExporter`  
       ‚Üí Pensez √† g√©rer la profondeur d‚Äô√©criture avec une variable d‚Äôinstance.
    4. Testez votre architecture en v√©rifiant qu‚Äôun changement de format ne n√©cessite **aucune modification** du code de `Catalogue`.

    üìò Exemple attendu pour le JSON (indentation facultative) :

    ```json
    {"@type":"catalogue", 
        "contenu":[
            {"@type":"produit",
                 "contenu":[
                        {"@type":"designation", "contenu":["texte":"souris"]},
                        {"@type":"prix", "contenu":["texte":"30.0"]}
                        ]
            },
            {"@type":"produit",
                 "contenu":[
                        {"@type":"designation", "contenu":["texte":"ordi"]},
                        {"@type":"prix", "contenu":["texte":"600.0"]}
                        ]
            }
        ]
    }
    ```


---
## Exercice 2 : Loi de D√©m√©ter

!!! Question "Question 1 ‚Äî Comprendre et appliquer la loi de D√©m√©ter"

    On dispose de l‚Äôarchitecture suivante repr√©sentant une entreprise :
    
    ![](images/architecture1.png){ width="50%" }

    ??? note "PlantUML"
        ```puml
        @startuml
        skin rose
        class Employ√© {
            nom
        }
        Entreprise o- D√©partement
        D√©partement o- Service
        Service o-- Equipe
        Equipe o--- Employ√©
        Equipe --> Employ√© : directeur
        @enduml
        ```
    

    Une m√©thode du programme vise √† retourner la liste des **noms des directeurs d‚Äô√©quipe**.

    üí≠ **Questions de r√©flexion**

    - Cette m√©thode respecte-t-elle la **loi de D√©m√©ter** ? 
    - Quels sont les sympt√¥mes d‚Äôune violation de cette loi dans le code actuel ?
    - Que se passerait-il si la hi√©rarchie de classes changeait (ajout d‚Äôun niveau, renommage, etc.) ?

    üí° **Travail demand√©**

    - Refactorez la m√©thode de mani√®re √† respecter la loi de D√©m√©ter.  
    - Testez que la m√©thode fonctionne toujours apr√®s la modification.

---

!!! Question "Question 2 ‚Äî G√©n√©raliser la notion de direction"

    On d√©couvre ensuite que **toutes les entit√©s** (Entreprise, D√©partement, Service, √âquipe) peuvent avoir un **directeur**.

    Le mod√®le devient alors :

    ![](images/architecture2.png){ width="50%" }

    ??? note "PlantUML"
        ```puml
        @startuml
        skin rose
        Interface AvecDirecteur
        AvecDirecteur -> Employ√© : directeur
        class Employ√© {
            nom
        }
        Entreprise o- D√©partement
        D√©partement o- Service
        Service o- Equipe

        Entreprise --|> AvecDirecteur
        D√©partement --|> AvecDirecteur
        Service --|> AvecDirecteur
        Equipe --|> AvecDirecteur
        @enduml
        ```

    

    üí≠ **R√©flexion**

    - Comment adapter votre solution pr√©c√©dente pour qu‚Äôelle fonctionne avec cette nouvelle hi√©rarchie ?  
    - Votre code reste-t-il conforme √† la **loi de D√©m√©ter** ?
    - Faut-il introduire une abstraction (interface, m√©thode commune, ou visiteur) pour traiter toutes ces entit√©s de mani√®re uniforme ?

    üí° **Travail demand√©**

    - Refactorez votre code pour int√©grer la notion d‚Äô`AvecDirecteur`.
    


---


## Exercice 3 : SOLID et refactorisation

!!! Question "Question 1 ‚Äî Identifier les violations des principes SOLID"

    üí≠ **Travail d‚Äôanalyse**

    - Parcourez votre code des exercices pr√©c√©dents.  
    - Pour chaque principe SOLID (**SRP, OCP, LSP, ISP, DIP**), identifiez :
        - un endroit o√π le principe est **respect√©** ;
        - un endroit o√π il est **viol√©** (m√™me l√©g√®rement).  
    - Justifiez vos r√©ponses.

    üí° **Extension possible**

    - Proposez des **refactorisation** pour corriger les violation identifi√©e.  


---
!!! info "Remarque"

    Pour cr√©er un site web avec le rapport de test, utilisez la commande Maven suivante :
    
    ```bash
    mvn surefire-report:report
    ```
